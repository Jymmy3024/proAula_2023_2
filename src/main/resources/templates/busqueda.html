

<html xmlsn:th="http://www.thymeleaf.org">
    <head>
        <title>Busqueda</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Link Boostrap 5 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
              rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

        <!-- Link Swiper's CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
        <style th:replace="~{plantillas/indexPartes :: estilos}"></style>
        <style>
            *{
                margin:0;
                padding:0;
                box-sizing: border-box;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

            }
            body {
                background-image: url('https://www.enretail.com/wp-content/uploads/2020/03/eCommerce-1.jpg');
                margin-top: auto;
                background-size: cover;
                background-repeat: no-repeat;
                background-attachment: fixed;
            }

            .container{
                width: 100%;
                min-height: 700px;               
                align-items: center;
                justify-content: center;
                margin-bottom: 5em;
                margin-right: 2em;
                margin-left: 2em;
            }

            .section{
                width: 100%;
                height: 100%;

            }

            .swiper {
                width: 100%;
                height: 400px;
                max-height: 340px;
            }


            .swiper .swiper-slide{
                width: 100%;
                height: 100%;
                max-height: 340px;
            }

            .swiper-slide .card{
                height: 100%;
                width: 200px;
            }

            .card-body{
                margin: 0;
            }

            .card-description{
                align-items: center;
                margin: 0.05em;
                margin-bottom: 0.5em;
                overflow: visible;
            }

            .card-title{
                text-align: center;
                color: dodgerblue;
                margin: 0.25em;
            }

            .swiper-title{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                text-align: left;
                box-sizing: border-box;
                box-shadow: 0 0 20px rgba(196, 196, 196, 0.5);
            }


            /*SWIPER SLIDE DE TIENDAS*/
            .swiper#swiper-tiendas{
                width: 100%;
                height: 30%;
                max-height: 200px;
            }

            .swiper#swiper-tiendas .swiper-slide#swiper-slide-tiendas{
                text-align: center;
                display: flex;
                justify-content: center;
                align-items: center;
                width: 100%;
                height: 100%;
            }

            .swiper-slide#swiper-slide-tiendas .card#card-tiendas{
                height: 200px;
                width: 100%;
                border-radius: 2em;
                overflow: hidden;
                margin: 4px;
                box-shadow: 0 0 10px rgba(196, 196, 196, 0.1);
            }
            .card#card-tiendas .card-image#card-image-tiendas {
                display: flow;
                width: 100%;
                height: 155px;
                object-fit: cover;
            }



        </style>
    </head>

    <body>
        <header th:replace="~{plantillas/indexPartes :: cabecera}"></header>

        <div th:if='${busqueda} != null' class="text-center" style="background-color: gainsboro" >
            <h3 class="text-dark" th:text="|Resultados de '${busqueda}'|"></h3>
        </div>
        <br>
        <div class="container">

            <div th:if="${exception} != null">
                <span class="alert alert-danger" th:text="${exception}"></span>
            </div>
            <div th:if='${tiendas != null &&  !tiendas.empty}'>
                <h4 class="swiper-title" id="swiper-title-tiendas">Tiendas</h4>
                <section class="swiper mySwiper" id="swiper-tiendas">                
                    <div class="wrapper swiper-wrapper" id="swiper-wrapper-tiendas" th:if="${tiendas!= null && !tiendas.empty}">
                        <div class="item swiper-slide" id="swiper-slide-tiendas" th:each="t : ${tiendas}">
                            <a th:href="@{#}" class="text-decoration-none">
                                <div class="card" id="card-tiendas">                                                                
                                    <div class="card-title" id="card-title-tiendas">
                                        <h5 th:text="${t.nombre}"></h5>
                                    </div>
                                    <img class="card-image" id="card-image-tiendas" th:src="@{/assets/{filename}(filename=${t.ruta_imagen})}" th:alt="@{${t.ruta_imagen}}"/>
                                </div>
                            </a>     
                        </div>                    
                    </div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-pagination"></div>
                </section>    
            </div>
            <br>              
            <div th:if='${productosInTienda != null &&  !productosInTienda.empty}' th:each="t : ${productosInTienda}">
                <br>
                <h4 class="swiper-title" th:text="${t.nombre}"></h4>
                <section class="swiper mySwiper" >                
                    <div class="wrapper swiper-wrapper">
                        <div class="item swiper-slide" th:each="p : ${t.listaProductos}">
                            <div class="card">
                                <img class="card-img" th:src="@{/assets/{filename}(filename=${p.productoGlobal.ruta_imagen})}"/>
                                <div class="card-body">
                                    <p class="card-title fw-bold fs-6" th:text="${p.productoGlobal.nombre}"></p>
                                    <p class="card-text" th:text="'Precio: '+'$'+${p.precioUnitario}"></p>
                                </div>
                                <div class="d-flex justify-content-between ps-sm-3 pb-sm-2">
                                    <form th:action="@{/}" method="POST">
                                        <input type="hidden" name="id" id="id" th:value="${p.id}" />
                                        <input type="submit" class="btn btn-secondary btn-sm" 
                                               style="--bs-btn-font-size: .75rem;" name="Detalles" value="Detalles">
                                        <input type="submit" class="btn btn-success btn-sm" 
                                               style="--bs-btn-font-size: .75rem;" name="Comprar" value="Agregar al Carrito">
                                    </form>
                                </div>
                            </div>  
                        </div>                    
                    </div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-pagination"></div>
                </section>    
            </div>            

            <div th:if="${productosInTienda == NULL AND tiendas == NULL}">
                <div class="card align-items-center"><h4 class='text-danger'>No se encontraron resultados</h4></div>
            </div>
        </div>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <!--<footer th:replace="~{plantillas/indexPartes :: piePagina}"></footer>-->

        <!-- Swiper JS -->
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

        <!-- Initialize Swiper -->
        <script>
            var swiper = new Swiper(".mySwiper", {
                slidesPerView: 3,
                spaceBetween: 30,
                freeMode: true,
                //loop: true,
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                },
                breakpoints: {
                    320: {
                        slidesPerView: 2,
                        spaceBetween: 20,
                    },
                    768: {
                        slidesPerView: 4,
                        spaceBetween: 40,
                    },
                    1024: {
                        slidesPerView: 5,
                        spaceBetween: 50,
                    },
                },
                mousewheel: false,
                keyboard: true,
            });
        </script>

    </body>
    <footer th:replace="~{plantillas/indexPartes :: piePagina}"></footer>
</html>